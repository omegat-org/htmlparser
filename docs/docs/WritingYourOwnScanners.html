<html><head><title>Writing Your Own Scanners</title></head><body><DIV CLASS="wikitext">
<P><B>Writing Your Own Scanners</B></P>
<P>There are two types of scanners, depending on the type of tags that you wish to parse:</P>
<UL>
<LI><A CLASS="wiki" HREF="TagScanner.html">TagScanner</A> - for parsing tags that have no child elements</LI>
<LI><SPAN CLASS="wikiunknown"><U>CompositeTagScanner</U></SPAN> - for parsing tags with children</LI></UL>
<P>Your scanner should subclass either of these two classes. You should then register your scanner with the parser with a call like:
parser.addScanner(new <SPAN CLASS="wikiunknown"><U>MyOwnScanner</U></SPAN>());</P>
<P><B>The Anatomy of a Scanner</B></P>
<P>The scanner allows you to customize parts of the scanning process. The scanning process is :<BR/><BR/>1. Given a tag, match the tag name with a registered scanner<BR/><BR/>2. If a match is found (using getId()-  which you MUST override), a closer match or special processing can be done by calling the evaluate() method of the scanner. This is optional, subclasses don't have to override the evaluate() method.<BR/><BR/>3. If a match was found, call the scan() method. For both <A CLASS="wiki" HREF="TagScanner.html">TagScanner</A> and <SPAN CLASS="wikiunknown"><U>CompositeTagScanner</U></SPAN>, overriding this method is optional, and NOT recommended for standard cases. The default scan() methods will make a call to createTag.<BR/><BR/>4. createTag describes the creation of a new tag. This method MUST be overridden in your scanner.<BR/><BR/></P>
<P><B>For your own scanner - simply override</B> :<BR/><BR/>1. getID() and have it return an array of strings that will be matched against the tag. For most cases, a single string is enough.<BR/><BR/>2. createTag() and have it create your special tag. The data needed for construction of your tag will be within tagData and compositeTagData (mostly within the latter if you are creating a composite tag - a tag with children).<BR/><BR/></P>
<P>Note: Tags with children must subclass <SPAN CLASS="wikiunknown"><U>CompositeTag</U></SPAN></P>
<P><B>Examples</B></P>
<P>1. Simple tag with no children</P>
<PRE>public class MySimpleScanner extends TagScanner {
   private static String [] MATCH_ID = {"MYSPECIALTAG"};
   ..
   public String getID() {
       return MATCH_ID;
   }

   protected Tag createTag(TagData tagData, Tag tag, String url) {
      return new MySimpleTag(tagData,..);
   }
}

public class MySimpleTag extends Tag {
   public MySimpleTag(TagData,..) {
   }
}</PRE>
<P>2. Composite tag with children</P>
<PRE>public class MyCompositeScanner extends CompositeTagScanner {
   private static String [] MATCH_ID = {"MYSPECIALTAG"};
   ..
   public String getID() {
       return MATCH_ID;
   }

   protected Tag createTag(TagData tagData, CompositeTagData compositeTagData) {
      return new MyCompositeTag(tagData,compositeTagData);
   }

}

public class MyCompositeTag extends CompositeTag {
   public MyCompositeTag(TagData tagData, CompositeTagData compositeTagData) {
       //..
       // If you wish to collect attributes from the start tag, you could do:
       // String attributeValue = compositeTagData.getStartTag().getAttribute(atributeName);
       //
       // To collect nodes of a particular type,
       // you could do:
       // Node [] myNodes =
       //    compositeTagData.getChildren().searchFor(
       //       SomeTag.class
       //    ).toNodeArray();
   }
}</PRE>
<P>You can customize the composite tag with an array of tag(strings) which indicate when to trigger corrections. You can also specify if you wish to prevent the same tag from appear as its child. Check the javadocs of <SPAN CLASS="wikiunknown"><U>CompositeTagScanner</U></SPAN> for more info.</P></DIV><DIV ID="actionbar" CLASS="toolbar"><HR NOSHADE="noshade" CLASS="printer"/><P CLASS="editdate">Last edited on Sunday, April 13, 2003  4:33:18 pm.</P><HR NOSHADE="noshade" CLASS="toolbar"/></body></html>