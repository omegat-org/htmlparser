<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body>
<h2><strong>Web Ripper - Modifying Links and Image Locations</strong> </h2>
<h3><strong>Applicability</strong></h3>
<p>When designing rippers that rip web pages and save it to disk, one needs to 
  be able to modify the relative urls and image locations, so that they refer 
  resources on the hard disk instead of the internet. The architecture of HTMLParser 
  enables you to do this very cleanly.</p>
<h3><strong>A Non-Modifying Ripper</strong></h3>
<p>A non-modifying ripper would be written in a very similar manner as the <a href="crawler.html">Web 
  Crawler</a>. We're basically parsing a page, and making a call to each node's 
  toHTML() method in order to reconstruct it.
  <!-- ======================================================== -->
  <!-- = Java Sourcecode to HTML automatically converted code = -->
  <!-- =   J2H V2.0  2002 by Markus Gebhard  markus@jave.de   = -->
  <!-- =     Further information: http://www.java2html.de     = -->
</p>
<center>
 <table  align="center" border="2" cellpadding="3" cellspacing="0" bgcolor="#FFFBF0">
   <tr>
  <!-- start line numbers -->
   <td align="right" valign="top">
    <code>
     <font color="#808080">
1<br>2<br>3<br>4<br>5<br>6<br>
   </font>
    </code>
   </td>
  <!-- end line numbers -->
  <!-- start source code -->
   <td valign="top">
    <code>
<font color="#c0c0c0">&nbsp;&nbsp;</font><font color="#000000">...<br>
&nbsp;&nbsp;HTMLNode&nbsp;node;<br>
        &nbsp;&nbsp;</font><font color="#0000c0">for&nbsp;</font><font color="#000000">(</font><font color="#000000">HTMLEnumeration&nbsp;e&nbsp;=&nbsp;parser.elements</font><font color="#000000">()</font><font color="#000000">;&nbsp;e.hasMoreNode</font><font color="#000000">s()</font><font color="#000000">;</font><font color="#000000">)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">node&nbsp;=&nbsp;e.nextHTMLNode</font><font color="#000000">()</font><font color="#000000">;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeToFileOnDisk</font><font color="#000000">(</font><font color="#000000">node.toHTML</font><font color="#000000">())</font><font color="#000000">;<br>
&nbsp;&nbsp;}</font></code>
    
   </td>
  </tr>
  <!-- end source code -->
  <!-- start J2H link -->
   <tr>
    <td colspan=2 align=right>
<small>
<a href="http://www.java2html.de" target="_blank">Java2html</a>
</small>
    </td>
   </tr>
  <!-- end J2H link -->
 </table>
</center>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->
<h3>Modifying Rippers</h3>
<p>Now, we need to be able to modify the link before it is written to disk. One 
  way is to check if the node is a link or an image tag, and if so, don't call 
  its default toHTML(), but put in our own adapted code.</p>
<p>However, we have a more elegant solution.</p>
<p><strong>Add your own Renderer</strong></p>
<p>You can implement the HTMLRenderer interface to define your own renderer. Your 
  renderer would look like :
  <!-- ======================================================== -->
  <!-- = Java Sourcecode to HTML automatically converted code = -->
  <!-- =   J2H V2.0  2002 by Markus Gebhard  markus@jave.de   = -->
  <!-- =     Further information: http://www.java2html.de     = -->
</p>
<center>
 <table  align="center" border="2" cellpadding="3" cellspacing="0" bgcolor="#FFFBF0">
   <tr>
  <!-- start line numbers -->
   <td align="right" valign="top">
    <code>
     <font color="#808080">
1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>
11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>
   </font>
    </code>
   </td>
  <!-- end line numbers -->
  <!-- start source code -->
   <td valign="top">
    <code>
<font color="#0000c0">public&nbsp;class&nbsp;</font><font color="#000000">RipperRenderer&nbsp;</font><font color="#0000c0">implements&nbsp;</font><font color="#000000">HTMLRenderer&nbsp;{<br>
&nbsp;&nbsp;</font><font color="#0000c0">public&nbsp;</font><font color="#000000">String&nbsp;renderLinksToHTML(HTMLLinkTag&nbsp;linkTag)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;modifiedLink&nbsp;=&nbsp;modifyLink(linkTag.getLink());<br>
&nbsp;&nbsp;&nbsp;&nbsp;linkTag.setLink(modifiedLink);<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000c0">return&nbsp;</font><font color="#000000">linkTag.toHTML();<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;</font><font color="#0000c0">public&nbsp;</font><font color="#000000">String&nbsp;renderImagesToHTML(HTMLImageTag&nbsp;imageTag)&nbsp;{<br>
        &nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;modifiedImageURL&nbsp;=&nbsp;modifyImageURL(imageTag.getImageURL());<br>
        &nbsp;&nbsp;&nbsp;&nbsp;imageTag.setImageURL(modifiedImageURL);<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000c0">return&nbsp;</font><font color="#000000">imageTag.toHTML();<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;</font><font color="#0000c0">private&nbsp;</font><font color="#000000">String&nbsp;modifyLink(String&nbsp;link)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#008000">//&nbsp;Put&nbsp;your&nbsp;modification&nbsp;logic&nbsp;here<br>
&nbsp;&nbsp;</font><font color="#000000">}<br>
        &nbsp;&nbsp;</font><font color="#0000c0">private&nbsp;</font><font color="#000000">String&nbsp;modifyImageURL(String&nbsp;imageURL)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#008000">//&nbsp;Put&nbsp;your&nbsp;modification&nbsp;logic&nbsp;here<br>
&nbsp;&nbsp;</font><font color="#000000">}<br>
}</font></code>
    
   </td>
  </tr>
  <!-- end source code -->
  <!-- start J2H link -->
   <tr>
    <td colspan=2 align=right>
<small>
<a href="http://www.java2html.de" target="_blank">Java2html</a>
</small>
    </td>
   </tr>
  <!-- end J2H link -->
 </table>
</center>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->
<p><strong>Modify the Iteration Loop</strong></p>
<p>All thats left for you to do now, is to use this renderer in your parsing loop 
  (the code in Non-modifying Rippers above).
  <!-- ======================================================== -->
  <!-- = Java Sourcecode to HTML automatically converted code = -->
  <!-- =   J2H V2.0  2002 by Markus Gebhard  markus@jave.de   = -->
  <!-- =     Further information: http://www.java2html.de     = -->
</p>
<center>
 <table  align="center" border="2" cellpadding="3" cellspacing="0" bgcolor="#FFFBF0">
   <tr>
  <!-- start line numbers -->
   <td align="right" valign="top">
    <code>
     <font color="#808080">
1<br>2<br>3<br>4<br>5<br>6<br>7<br>
   </font>
    </code>
   </td>
  <!-- end line numbers -->
  <!-- start source code -->
   <td valign="top">
    <code>
<font color="#000000">  ...<br>
&nbsp;&nbsp;RipperRenderer&nbsp;renderer&nbsp;=&nbsp;</font><font color="#0000c0">new&nbsp;</font><font color="#000000">RipperRenderer</font><font color="#000000">()</font><font color="#000000">;<br>
  HTMLNode node;<br>
          for </font><font color="#000000">(</font><font color="#000000">HTMLEnumeration e = parser.elements</font><font color="#000000">()</font><font color="#000000">; e.hasMoreNode</font><font color="#000000">s()</font><font color="#000000">;</font><font color="#000000">)</font><font color="#000000"> </font><font color="#000000">{<br>
</font><font color="#000000">      node = e.nextHTMLNode</font><font color="#000000">()</font><font color="#000000">;<br>
      writeToFileOnDisk</font><font color="#000000">(</font><font color="#000000">node.toHTML</font><font color="#000000">(</font><font color="#000000">renderer</font><font color="#000000">))</font><font color="#000000">;<br>
  </font><font color="#000000">}&nbsp;</font></code>
    
   </td>
  </tr>
  <!-- end source code -->
  <!-- start J2H link -->
   <tr>
    <td colspan=2 align=right>
<small>
<a href="http://www.java2html.de" target="_blank">Java2html</a>
</small>
    </td>
   </tr>
  <!-- end J2H link -->
 </table>
</center>
<!-- =       END of automatically generated HTML code       = -->
<!-- ======================================================== -->
<p>The result of this code is that, for all nodes other than links and images, 
  the default toHTML() is called, and for links and images, control is passed 
  to the renderer to be able to modify them cleanly to store them to disk.</p>
<p><a href="index.html">Back to Samples</a><br>
  <a href="../index.html">Back to HTMLParser Home Page</a></p>
</body>
</html>
